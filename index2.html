<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <title>採用サイト</title>
  <base target="_top">
</head>

<body>

  <?var url = getScriptUrl();?>

  <div style="height:150px"></div>
  <table border="1" style="border-collapse: collapse;margin-left: 970px;margin-bottom: 30px">
    <tr>
      <th width="150" height="40" style="font-weight: normal" id="id">
        <?=id?>
      </th>
    </tr>
  </table>

  <table border="1" valign="middle" style="margin: auto; border-collapse: collapse" width="900" height="300">

    <?
let valuesHT = getdata2();
?>

    <tr>
      <th width="200" style="font-weight: normal">日時</th>
      <th width="400" style="font-weight: normal">内容</th>
      <th width="300" style="font-weight: normal">申込状況</th>
    </tr>
    <tr>
      <td>
        <?=valuesHT[0][0]?>
      </td>
      <td><a href='<?!=url?>?id=<?=id?>&enumber=1&page=event'>
          <?=valuesHT[1][0]?>
        </a></td>
      <td>
        <div>
          <button style="margin-right: 15px;margin-left: 15px;color:white;background-color:#FF9966;font-size:10;
                   width:100px;height:50px;outline: none;border-radius:10px;border:none;" type="button" name="expAppli"
            id="expAppli" onclick="expClick(1)">申込</button>
          <button style="color:white;background-color:#999999;font-size:10;
                   width:150px;height:50px;outline: none;border-radius:10px;border:none;" type="button" name="expCan"
            id="expCan" onclick="expClick(0)">キャンセル</button>
        </div>
      </td>
    </tr>
    <script>
      let id = document.getElementById("id").innerHTML;
      google.script.run
        .withSuccessHandler(onSuccessA)
        .getdata3(id);

      function onSuccessA(rowD) {
        console.log(rowD);
        if (rowD[0] === '〇') {
          document.getElementById('expAppli').style.backgroundColor = '#999999';
          document.getElementById('expCan').style.backgroundColor = '#FF9966';
        }
      }

      function expClick(n) {
        let id = document.getElementById("id").innerHTML;
        google.script.run
          .withSuccessHandler(onSuccess)
          .inputSheet2('exp', n, id)

        function onSuccess(n) {
          if (n === 1) {
            document.getElementById('expAppli').style.backgroundColor = '#999999';
            document.getElementById('expCan').style.backgroundColor = '#FF9966';
          } else {
            document.getElementById('expAppli').style.backgroundColor = '#FF9966';
            document.getElementById('expCan').style.backgroundColor = '#999999';
          }
        }
      }
    </script>
    <tr>
      <td>
        <?=valuesHT[0][1]?>
      </td>
      <td><a href='<?!=url?>?id=<?=id?>&enumber=2&page=event'>
          <?=valuesHT[1][1]?>
        </a></td>
      <td>
        <div>
          <button style="margin-right: 15px;margin-left: 15px;color:white;background-color:#FF9966;font-size:10;
                   width:100px;height:50px;outline: none;border-radius:10px;border:none;" type="button" name="infAppli"
            id="infAppli" onclick="infClick(1)">申込</button>
          <button style="color:white;background-color:#999999;font-size:10;
                   width:150px;height:50px;outline: none;border-radius:10px;border:none;" type="button" name="infCan"
            id="infCan" onclick="infClick(0)">キャンセル</button>
        </div>
      </td>
    </tr>
    <script>
      let ida = document.getElementById("id").innerHTML;
      google.script.run
        .withSuccessHandler(onSuccessA)
        .getdata3(ida);

      function onSuccessA(rowD) {
        console.log(rowD);
        if (rowD[1] === '〇') {
          document.getElementById('infAppli').style.backgroundColor = '#999999';
          document.getElementById('infCan').style.backgroundColor = '#FF9966';
        }
      }

      function infClick(n) {
        let id = document.getElementById("id").innerHTML;
        google.script.run
          .withSuccessHandler(onSuccess)
          .inputSheet2('inf', n, id)

        function onSuccess(n) {
          if (n === 1) {
            document.getElementById('infAppli').style.backgroundColor = '#999999';
            document.getElementById('infCan').style.backgroundColor = '#FF9966';
          } else {
            document.getElementById('infAppli').style.backgroundColor = '#FF9966';
            document.getElementById('infCan').style.backgroundColor = '#999999';
          }
        }
      }
    </script>
    <tr>
      <td>
        <?=valuesHT[0][2]?>
      </td>
      <td><a href='<?!=url?>?id=<?=id?>&enumber=3&page=event'>
          <?=valuesHT[1][2]?>
        </a></td>
      <td>
        <div>
          <button style="margin-right: 15px;margin-left: 15px;color:white;background-color:#FF9966;font-size:10;
                   width:100px;height:50px;outline: none;border-radius:10px;border:none;" type="button" name="tesAppli"
            id="tesAppli" onclick="tesClick(1)">申込</button>
          <button style="color:white;background-color:#999999;font-size:10;
                   width:150px;height:50px;outline: none;border-radius:10px;border:none;" type="button" name="tesCan"
            id="tesCan" onclick="tesClick(0)">キャンセル</button>
        </div>
      </td>
    </tr>
    <script>
      let idb = document.getElementById("id").innerHTML;
      google.script.run
        .withSuccessHandler(onSuccessA)
        .getdata3(idb);

      function onSuccessA(rowD) {
        console.log(rowD);
        if (rowD[2] === '〇') {
          document.getElementById('tesAppli').style.backgroundColor = '#999999';
          document.getElementById('tesCan').style.backgroundColor = '#FF9966';
        }
      }

      function tesClick(n) {
        let id = document.getElementById("id").innerHTML;
        google.script.run
          .withSuccessHandler(onSuccess)
          .inputSheet2('tes', n, id)

        function onSuccess(n) {
          if (n === 1) {
            document.getElementById('tesAppli').style.backgroundColor = '#999999';
            document.getElementById('tesCan').style.backgroundColor = '#FF9966';
          } else {
            document.getElementById('tesAppli').style.backgroundColor = '#FF9966';
            document.getElementById('tesCan').style.backgroundColor = '#999999';
          }
        }
      }   
    </script>
  </table>

  <div style="padding-left: 200px;padding-top: 40px">
    <button style="color:black;background-color:white;font-size:10;
                   width:120px;height:50px;outline: none;border-radius:10px;" type="button"
      onclick="window.top.location.href = '<?!=url?>?page=index1';">戻る</button>
  </div>

</body>

</html>
